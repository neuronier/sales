<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	template="/templates/masterLayout.xhtml"
	xmlns:sec="http://www.springframework.org/security/tags">

	<ui:define name="pageTitle">#{out.orders_title}</ui:define>
	<ui:define name="header">#{out.orders_title}</ui:define>
	<ui:define name="head-extra">
		<style>
.dataTableContainer tr {
	vertical-align: top;
}

#orderDetailsCell {
	width: 80%;
	padding: 40px;
}
</style>
	</ui:define>
	<ui:define name="content">


		<p:fieldset legend="#{out.orders_details_dialog_head}"
			style="margin-bottom:20px">

			<table class="dataTableContainer">
				<tr>
					<td id="orderDetailsCell"><h:form id="orderForm">
							<p:dataTable id="orderDT" scrollable="true" scrollHeight="400"
								value="#{orderController.lazyOrderModul}" var="order"
								selectionMode="single"
								selection="#{orderController.selectedOrder}"
								paginatorTemplate="{RowsPerPageDropdown} {FirstPageLink} {PreviousPageLink} {CurrentPageReport} {NextPageLink} {LastPageLink}"
								rowsPerPageTemplate="5,10,15" lazy="true" paginator="true"
								rows="10" emptyMessage="#{out.empty_message}">

								<p:ajax event="rowSelect" update=":orderForm:orderDT"
									listener="#{orderController.onRowSelected}" />

								<p:column headerText="Id" filterStyle="width:80%;">
									<h:outputText value="#{order.orderId}" />
								</p:column>
								<!-- 								<p:column headerText="#{out.orders_ordered_products}" -->
								<!-- 									filterStyle="width:80%;"> -->
								<!-- 									<h:outputText value="#{order.productType.name}" /> -->
								<!-- 								</p:column> -->

								<!-- 								<p:column headerText="#{out.orders_quantity}" -->
								<!-- 									filterStyle="width:80%;"> -->
								<!-- 									<h:outputText value="#{order.quantity}" /> -->
								<!-- 								</p:column> -->


								<p:column headerText="#{out.warehouse}" filterStyle="width:80%;">
									<h:outputText value="" />
								</p:column>
								<p:column headerText="#{out.orders_details_dialog_date}"
									filterStyle="width:80%;">
									<h:outputText value="#{order.date}" />
								</p:column>
								<p:column headerText="#{out.orders_status}"
									filterStyle="width:80%;">
									<h:outputText value="#{order.status}" />
								</p:column>
							</p:dataTable>
							<p:panelGrid id="btnPanel" columns="3">
								<p:commandButton value="#{out.orders_buttons_create}"
									action="#{orderController.addNewOrderButtonAction}"
									update=":orderForm" oncomplete="PF('addNewOrderDialog').show()" />
								
							</p:panelGrid>
						</h:form></td>
				</tr>
			</table>


			<p:dialog widgetVar="addNewOrderDialog"
				header="#{out.orders_create_dialog_head}" resizable="false"
				width="700">
				<h:form id="addNewOrderDialogForm">
					<p:panelGrid columns="2" cellpadding="2">
						<p:outputLabel value="#{out.orders_products}" />
						<p:panelGrid columns="3">
							<p:autoComplete id="product"
								value="#{orderController.selectedProductTypeName}"
								completeMethod="#{orderController.completeTextProduct}" />
							<p:inputText value="#{orderController.quantity}" size="2" />
							<p:commandButton value="#{out.orders_add}"
								actionListener="#{orderController.addToList}"
								update="addNewOrderDialogForm" />
						</p:panelGrid>
						<p:outputLabel value="" />


						<p:panelGrid columns="1" style="width: 100%">
							<p:dataTable id="addedProducts" var="products"
								value="#{orderController.products}" scrollable="true"
								scrollHeight="150" resizableColumns="true"
								selectionMode="single"
								selection="#{orderController.selectedProduct}"
								rowKey="#{products.name}">

								<p:ajax event="rowSelect"
									update=":addNewOrderDialogForm:addedProducts" />


								<p:column headerText="#{out.orders_ordered_products}">
									<h:outputText value="#{products.name}" />
								</p:column>
								<p:column headerText="#{out.orders_quantity}">
									<h:outputText value="#{products.quantity}" />
								</p:column>
							</p:dataTable>
							<p:commandButton value="#{out.userform_remove}"
								update="addedProducts"
								actionListener="#{orderController.removeFromList}"></p:commandButton>
						</p:panelGrid>




						<p:outputLabel value="#{out.orders_status}" />
						<p:panelGrid columns="1">
							<p:selectOneMenu id="status"
								value="#{orderController.selectedStatus}" effect="fold"
								editable="true">
								<f:selectItems value="#{orderController.status}" />
							</p:selectOneMenu>
						</p:panelGrid>
					</p:panelGrid>
					<p:commandButton value="#{out.profile_save}"
						actionListener="#{orderController.addNewOrder}"
						update=":orderForm:orderDT"
						oncomplete="PF('addNewOrderDialog').hide()" />
				</h:form>
			</p:dialog>

		</p:fieldset>
	</ui:define>
</ui:composition>