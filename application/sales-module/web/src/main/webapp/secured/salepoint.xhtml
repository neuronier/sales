<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui"
	template="/templates/masterLayout.xhtml">

	<ui:define name="pageTitle">#{out.admin_title}</ui:define>
	<ui:define name="header">#{out.admin_title}</ui:define>


	<ui:define name="content">
		<h2>Salepoint management</h2>
		<h:form id="form"
			style="max-width: 85%; margin-top: 45px; margin-left: auto; margin-right: auto;">
			<p:dataTable var="salesPoint"
				value="#{salesPointController.lazySalesPointModel}" paginator="true"
				rows="10"
				paginatorTemplate="{RowsPerPageDropdown} {FirstPageLink} {PreviousPageLink} {CurrentPageReport} {NextPageLink} {LastPageLink}"
				rowsPerPageTemplate="5,10,15" selectionMode="single"
				selection="#{salesPointController.selectedSalesPoint}"
				id="salesPointTable" lazy="true">

				<p:ajax event="rowSelect"
					listener="#{salesPointController.onRowSelect}"
					update=":form:removeButton,:form:updateButton,:updateSalesPointDialog" />

				<p:column headerText="#{out.salepointname}"
					sortBy="#{salesPoint.name}" filterBy="#{salesPoint.name}">
					<h:outputText value="#{salesPoint.name}" />
				</p:column>
	
				<p:column headerText="#{out.salepointcoladdress}" 
				 	sortBy="#{salesPoint.address}" filterBy="#{salesPoint.address}">
						<h:outputText value="#{salesPoint.address.zipCode} "/>
						<h:outputText value="#{salesPoint.address.city}&lt;br/&gt;" escape="false"/>
						<h:outputText value="#{salesPoint.address.street} "/>
						<h:outputText value="#{salesPoint.address.houseNumber}" />
				</p:column>

				<p:column headerText="#{out.salepointcolphone}">
					<h:outputText value="#{salesPoint.salePointPhoneNumber}" />
				</p:column>

				<p:column headerText="#{out.salepointcolwarehouse}">
					<h:outputText value="#{salesPoint.warehouse.warehouseName}" />
				</p:column>

			</p:dataTable>

			<div
				style="margin-top: 30px; display: table; margin-left: auto; margin-right: auto;">

				<p:commandButton value="#{out.addnew}" type="button"
					onclick="PF('createSalesPoint').show();" />

				<p:commandButton value="#{out.update}" type="button"
					id="updateButton"
					disabled="#{salesPointController.selectedSalesPoint == null}"
					onclick="PF('updateSalesPoint').show();" />

				<p:commandButton value="Delete" id="removeButton"
					update="form:salesPointTable,form:removeButton,form:updateButton"
					disabled="#{salesPointController.selectedSalesPoint == null}"
					actionListener="#{salesPointController.removeSalesPoint}" />

			</div>

		</h:form>
		<p:dialog id="adder" header="#{out.popupnewsalepoint}"
			widgetVar="createSalesPoint" showEffect="explode" hideEffect="bounce"
			mheight="100" modal="true" appendTo="@(body)">
			<h:form>
				<h:outputLabel for="salesPointName" value="#{out.salepointname}"
					style="font-weight:bold" />
				<p:inputText id="salesPointName" required="true"
					value="#{salesPointController.newSalesPointName}" />

				<h:outputLabel for="city" value="#{out.city}"
					style="font-weight:bold" />
				<p:selectOneMenu id="city" value="#{citySelectOneMenuView.city}"
					converter="cityConverter" panelStyle="width:180px" effect="fade"
					var="c" style="width:160px" filter="true"
					filterMatchMode="startsWith" editable="true">
					<f:selectItems value="#{citySelectOneMenuView.cities}" var="city"
						itemLabel="#{city}" itemValue="#{city}" />
					<p:column>
						<h:outputText value="#{c}" />
					</p:column>
				</p:selectOneMenu>

				<h:outputLabel for="streetName" value="#{out.streetname}"
					style="font-weight:bold" />
				<p:inputText id="streetName" required="true"
					value="#{salesPointController.streetName}" />
					
				<h:outputLabel for="houseNumber" value="#{out.housenumber}"
					style="font-weight:bold" />
				<p:inputText id="houseNumber" required="true"
					value="#{salesPointController.houseNumber}" />
					
				<h:outputLabel for="zipCode" value="#{out.zipcode}"
					style="font-weight:bold" />
				<p:inputText id="zipCode" required="true"
					value="#{salesPointController.zipCode}" />
					
					<h:outputLabel for="phoneNumber" value="#{out.phonenumber}"
					style="font-weight:bold" />
				<p:inputText id="phoneNumber" required="true"
					value="#{salesPointController.phoneNumber}" />
					
					<h:outputLabel for="warehouse" value="#{out.warehouse}"
					style="font-weight:bold" />
				<p:selectOneMenu id="warehouse" value="#{warehouseSelectOneMenuView.warehouseName}"
					converter="warehouseConverter" panelStyle="width:180px" effect="fade"
					var="w" style="width:160px" filter="true"
					filterMatchMode="startsWith" editable="true">
					<f:selectItems value="#{warehouseSelectOneMenuView.warehouses}" var="warehouse"
						itemLabel="#{warehouse}" itemValue="#{warehouse}" />
					<p:column>
						<h:outputText value="#{w}" />
					</p:column>
				</p:selectOneMenu>

				<p:commandButton value="Save" id="save"
					actionListener="#{salesPointController.saveNewSalesPoint}"
					update=":form:salesPointTable, :adder" icon="ui-icon-disk"
					oncomplete="PF('createSalesPoint').hide();" />
			</h:form>
		</p:dialog>

		<p:dialog header="#{out.popupmodifysalepoint}"
			widgetVar="updateSalesPoint" showEffect="explode"
			id="updateSalesPointDialog" hideEffect="bounce" mheight="100"
			modal="true" appendTo="@(body)">
			<h:form>
				<h:outputLabel for="salesPointName" value="#{out.salepointname}"
					style="font-weight:bold" />
				<p:inputText id="salesPointName" required="true"
					value="#{salesPointController.selectedSalesPoint.name}" />

				<h:outputLabel for="city" value="#{out.city}"
					style="font-weight:bold" />
				<p:selectOneMenu id="city" value="#{citySelectOneMenuView.city}"
					converter="cityConverter" panelStyle="width:180px" effect="fade"
					var="c" style="width:160px" filter="true"
					filterMatchMode="startsWith" editable="true">
					<f:selectItems value="#{citySelectOneMenuView.cities}" var="city"
						itemLabel="#{city}" itemValue="#{city}" />
					<p:column>
						<h:outputText value="#{c}" />
					</p:column>
				</p:selectOneMenu>

				<h:outputLabel for="streetName" value="#{out.streetname}"
					style="font-weight:bold" />
				<p:inputText id="streetName" required="true"
					value="#{salesPointController.selectedSalesPoint.address.street}" />
					
				<h:outputLabel for="houseNumber" value="#{out.housenumber}"
					style="font-weight:bold" />
				<p:inputText id="houseNumber" required="true"
					value="#{salesPointController.selectedSalesPoint.address.houseNumber}" />
					
				<h:outputLabel for="zipCode" value="#{out.zipcode}"
					style="font-weight:bold" />
				<p:inputText id="zipCode" required="true"
					value="#{salesPointController.selectedSalesPoint.address.zipCode}" />
					
					<h:outputLabel for="phoneNumber" value="#{out.phonenumber}"
					style="font-weight:bold" />
				<p:inputText id="phoneNumber" required="true"
					value="#{salesPointController.selectedSalesPoint.salePointPhoneNumber}" />
					
					<h:outputLabel for="warehouse" value="#{out.warehouse}"
					style="font-weight:bold" />
				<p:selectOneMenu id="warehouse" value="#{warehouseSelectOneMenuView.warehouseName}"
					converter="warehouseConverter" panelStyle="width:180px" effect="fade"
					var="w" style="width:160px" filter="true"
					filterMatchMode="startsWith" editable="true">
					<f:selectItems value="#{warehouseSelectOneMenuView.warehouses}" var="warehouse"
						itemLabel="#{warehouse}" itemValue="#{warehouse}" />
					<p:column>
						<h:outputText value="#{w}" />
					</p:column>
				</p:selectOneMenu>
			
				<p:commandButton value="Update" id="update"
					actionListener="#{salesPointController.updateSalesPoint}"
					update=":form:salesPointTable,:form:updateButton,:form:removeButton"
					icon="ui-icon-disk" oncomplete="PF('updateSalesPoint').hide();" />
			</h:form>
		</p:dialog>

	</ui:define>
</ui:composition>